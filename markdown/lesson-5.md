# Урок 5: Agentic RAG

## Введение

Agentic Retrieval-Augmented Generation (Agentic RAG) — это новая парадигма в области ИИ, где большие языковые модели (LLMs) не просто извлекают информацию, а **самостоятельно планируют свои следующие шаги**, используя внешние источники данных. В отличие от статических стратегий «сначала извлечь — потом ответить», Agentic RAG включает **итеративные вызовы LLM**, использование инструментов и структурированных выводов, а также **проверку и корректировку собственных действий**.

---

## Цели урока

После прохождения этого урока вы сможете:

* Понять, что такое Agentic RAG и как он отличается от традиционного RAG.
* Освоить итеративный стиль «maker-checker» — модель сама проверяет правильность результата.
* Осознать, как система самостоятельно планирует и корректирует своё поведение.
* Понять, как работает итеративный цикл с интеграцией инструментов и памятью.
* Разобраться, как Agentic RAG справляется с ошибками и самокорректируется.
* Понять границы автономии агентной модели.
* Познакомиться с практическими сценариями применения и ценностью Agentic RAG.
* Изучить вопросы прозрачности, доверия и соблюдения норм.

---

## Что такое Agentic RAG

Agentic RAG — это способ организации ИИ-систем, где LLM **не только извлекает знания**, но и **сама определяет, какие шаги предпринять** для получения качественного ответа. Она делает:

* Запрос →
* Использует инструмент →
* Анализирует результат →
* Повторяет при необходимости →
* Финализирует ответ

Этот итеративный цикл позволяет избежать ошибок, улучшить точность и снизить зависимость от предопределённых цепочек prompt'ов.

Пример инструментов:

* Поиск по векторной базе (Azure AI Search)
* SQL-запрос к базе (Azure SQL)
* Внешние API (Bing, внутренние данные)

---

## Владение логикой вывода (Owning the Reasoning Process)

Ключевая особенность Agentic RAG — **самостоятельное владение логикой решения задачи**.

Например, при формировании стратегии запуска продукта модель может:

1. Найти отчёты о рыночных трендах
2. Извлечь данные о конкурентах
3. Сопоставить с внутренними метриками продаж
4. Объединить всё в стратегию
5. Проверить результат и, при необходимости, повторить некоторые шаги

И всё это — **без заранее прописанной последовательности**.

---

## Интеграция инструментов и управление памятью

Agentic RAG работает в виде итеративного цикла:

1. **Начальный запрос** от пользователя
2. **Выбор инструмента** (если данных недостаточно)
3. **Анализ и корректировка запроса**
4. **Повтор до достижения нужного результата**
5. **Хранение состояния и памяти**, чтобы избежать повторов

Это даёт:

* Гибкость
* Постепенное уточнение
* Возможность решать сложные задачи без участия человека

---

## Самокоррекция и устойчивость к сбоям

Когда модель сталкивается с ошибками:

* Она **переформулирует запрос** или **меняет инструмент**
* Вызывает **диагностические функции** (например, трассировка Azure AI)
* Может запросить **вмешательство человека** при критических ошибках

Такой подход делает её устойчивой к нестабильности данных или неопределённым условиям.

---

## Границы автономии

Agentic RAG — это не AGI. Её автономия:

* **Ограничена областью задачи**
* **Зависит от доступных инструментов и данных**
* **Подчиняется установленным политикам и guardrails**

Она **не придумывает свои инструменты**, а лишь **наилучшим образом использует доступные**.

---

## Практические сценарии применения

* **Проверка нормативного соответствия** (compliance)
* **Юридический анализ**, где важна точность
* **Работа со сложными БД** (SQL, OneLake)
* **Долгие пользовательские сессии**, где нужно накапливать и использовать контекст

---

## Прозрачность, доверие, контроль

При использовании Agentic RAG важно:

* **Вести журнал действий** (audit trail)
* **Контролировать смещения и источники данных**
* **Подключать человека для ревью** при необходимости

Инструменты:

* Azure AI Tracing, GenAIOps — для мониторинга
* Azure AI Content Safety — для контроля рисков
* Модели в Azure Machine Learning — для анализа смещений

---

## Заключение

Agentic RAG — это **новый этап в развитии ИИ**, позволяющий системам не только извлекать информацию, но и **самостоятельно формулировать стратегию решения**, корректировать ошибки, использовать инструменты и выстраивать сложные логики. Это открывает возможности для создания **более надёжных и умных помощников**, особенно в бизнес-среде.

---
