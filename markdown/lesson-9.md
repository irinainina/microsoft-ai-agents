# Урок 9: Метапознание в AI-агентах

### Цели обучения

* Понять, как циклы рассуждения влияют на поведение агентов.
* Использовать планирование и оценку для создания самокорректирующихся агентов.
* Разработать агентов, способных к изменению собственного кода для решения задач.

---

### Что такое метапознание?

Метапознание — это способность "думать о мышлении". В контексте ИИ это означает, что агент может анализировать свои действия, оценивать собственную эффективность, исправлять ошибки и адаптироваться к новым условиям.

#### Зачем метапознание агентам?

* **Прозрачность**: агент объясняет свои решения.
* **Улучшенное рассуждение**: принимает более обоснованные решения.
* **Адаптация**: корректирует поведение в новых условиях.
* **Точность восприятия**: лучше интерпретирует данные.

#### Пример метапознания:

* Агент говорит: "Я выбрал дешёвые билеты, но мог упустить прямые рейсы. Перепроверю."
* Учитывает прошлые ошибки и меняет стратегию, а не просто результат.

---

### Компоненты AI-агента

* **Persona**: характер и стиль общения.
* **Инструменты**: доступные функции.
* **Навыки**: встроенные знания и опыт.

Пример: туристический агент, который на основе опыта и данных строит маршрут поездки, избегая прошлых ошибок.

---

### Метапознание в Travel Agent

#### Задача: спланировать поездку в Париж.

##### Этапы:

1. Сбор предпочтений пользователя (даты, бюджет, интересы).
2. Поиск информации (рейсы, отели, достопримечательности).
3. Генерация рекомендаций.
4. Получение и учёт обратной связи.

#### Ресурсы:

* Базы данных рейсов и отелей.
* Информация об объектах в Париже.
* История взаимодействия с пользователями.

#### Пример на Python:

```python
class Travel_Agent:
    def __init__(self):
        self.user_preferences = {}
        self.experience_data = []

    def gather_preferences(self, preferences):
        self.user_preferences = preferences

    def retrieve_information(self):
        flights = search_flights(self.user_preferences)
        hotels = search_hotels(self.user_preferences)
        attractions = search_attractions(self.user_preferences)
        return flights, hotels, attractions

    def generate_recommendations(self):
        flights, hotels, attractions = self.retrieve_information()
        return create_itinerary(flights, hotels, attractions)

    def adjust_based_on_feedback(self, feedback):
        self.experience_data.append(feedback)
        self.user_preferences = adjust_preferences(self.user_preferences, feedback)
```

---

### Планирование в агентах

#### Элементы:

* **Текущая задача**
* **Шаги к цели**
* **Ресурсы**
* **Опыт**

##### Этапы Travel Agent:

1. Сбор предпочтений
2. Поиск информации
3. Генерация рекомендаций
4. Представление пользователю
5. Сбор обратной связи
6. Корректировка
7. Финальное подтверждение
8. Бронирование
9. Поддержка во время поездки

---

### Система Corrective RAG

#### Что такое RAG?

* **RAG (Retrieval-Augmented Generation)** — комбинирует поиск и генерацию.
* Агент извлекает данные и использует их для создания ответов.

#### Corrective RAG — что добавляет?

* **Подсказки**: настраиваемые поисковые запросы.
* **Инструменты**: алгоритмы фильтрации и оценки релевантности.
* **Оценка**: анализ точности и корректировка поведения.

##### Пример использования в Travel Agent:

```python
feedback = {"liked": ["Louvre Museum"], "disliked": ["Eiffel Tower"]}
if "disliked" in feedback:
    preferences["avoid"] = feedback["disliked"]
new_attractions = search_attractions(preferences)
new_itinerary = create_itinerary(flights, hotels, new_attractions)
```

#### Выгоды:

* Улучшение качества рекомендаций.
* Адаптация на основе обратной связи.
* Меньше повторяющихся ошибок.

---

### Вывод

Метапознание делает AI-агентов более умными, гибкими и надёжными. Оно позволяет агентам не просто выполнять задачи, но и учиться на собственных ошибках, улучшая пользовательский опыт со временем.
